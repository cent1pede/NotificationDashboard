<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40">

<head>
   <link rel="icon" 
      type="image/png" 
      href="img/note-builder.png">
    <script src="http://www.datejs.com/build/date.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

    <meta http-equiv=Content-Type content="text/html; charset=UTF-8">
    <meta name=Generator content="Microsoft Word 15 (filtered medium)">
    <style>
        <!--
        /* Font Definitions */

        @font-face {
            font-family: "Cambria Math";
            panose-1: 2 4 5 3 5 4 6 3 2 4;
        }

        @font-face {
            font-family: Calibri;
            panose-1: 2 15 5 2 2 2 4 3 2 4;
        }

        /* Style Definitions */

        p.MsoNormal,
        li.MsoNormal,
        div.MsoNormal {
            margin: 0cm;
            margin-bottom: .0001pt;
            font-size: 11.0pt;
            font-family: "Calibri", sans-serif;
        }

        a:link,
        span.MsoHyperlink {
            mso-style-priority: 99;
            color: #0563C1;
            text-decoration: underline;
        }

        a:visited,
        span.MsoHyperlinkFollowed {
            mso-style-priority: 99;
            color: #954F72;
            text-decoration: underline;
        }

        p {
            mso-style-priority: 99;
            mso-margin-top-alt: auto;
            margin-right: 0cm;
            mso-margin-bottom-alt: auto;
            margin-left: 0cm;
            font-size: 12.0pt;
            font-family: "Times New Roman", serif;
        }

        p.msonormal0,
        li.msonormal0,
        div.msonormal0 {
            mso-style-name: msonormal;
            mso-style-priority: 99;
            mso-margin-top-alt: auto;
            margin-right: 0cm;
            mso-margin-bottom-alt: auto;
            margin-left: 0cm;
            font-size: 12.0pt;
            font-family: "Times New Roman", serif;
        }

        span.EmailStyle19 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.apple-converted-space {
            mso-style-name: apple-converted-space;
        }

        span.EmailStyle21 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle22 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle23 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle24 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle25 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle26 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle27 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle28 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle29 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle30 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle31 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle32 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle33 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle34 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle35 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        span.EmailStyle37 {
            mso-style-type: personal;
            font-family: "Calibri", sans-serif;
            color: #1F497D;
        }

        span.EmailStyle38 {
            mso-style-type: personal-compose;
            font-family: "Calibri", sans-serif;
            color: windowtext;
        }

        .MsoChpDefault {
            mso-style-type: export-only;
            font-size: 10.0pt;
        }

        @page WordSection1 {
            size: 612.0pt 792.0pt;
            margin: 2.0cm 42.5pt 2.0cm 3.0cm;
        }

        div.WordSection1 {
            page: WordSection1;
        }

        .textboxes {
            height: 140px;
            width: 400px;

        }

        .textboxes-service {
            height: 70px;
            width: 400px;

        }

        .downtime-controls {
            display: flex; //justify-content: space-between;
            width: 400px;
            height: 20px;
        }

        .downtime-header-1 {
            height: 7px;

        }

        .downtime-header-2 {
            margin-left: 5px;
        }

        .control {
            display: flex;

        }

        .downtime-checkbox {
            margin-top: 18px;
            margin-left: 10px;
        }

        .downtime-insert-header {
            margin-bottom: 5px;
        }

        .name {
            margin-top: 5px;
        }

        .downtimedigits {
            height: 50px;
        }

        .downtime-free {
            display: none;
        }

        .required-fields::placeholder {
            filter: opacity(45%);
        }

        #mytable {
            outline: 5px solid red;
        }





        -->

    </style>
    <!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]-->
    <!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
</head>

<body lang=RU link="#0563C1" vlink="#954F72">
    <div class="controls" style="display: block;position: absolute;">
        <div class="change">
            <p>Введите номер Change Request из remedy</p>
            <input type="text" class="changefield" id="changefield">
            <button onclick="getSingleChangeInfo()">Заполнить из CRQ</button><br><br>
            <button id="copybutton" data-clipboard-target="#notification">Копировать в буфер обмена</button>
        </div>

        <div class="reminder">
            <p class="downtime-header">Reminder?</p>
            <input type="checkbox" id="reminder" onclick="enableReminder()" />
        </div>
        <p class="note-box">Текст на английском</p>
        <textarea id="insert-note-en" class="textboxes">During the maintenance works we will</textarea><br>
        <p class="note-box">Текст на русском</p>
        <textarea id="insert-note-ru" class="textboxes">Во время проведения работ мы</textarea><br>
        <p class="name">Сервисы</p>
        <textarea id="insert-service" class="textboxes-service"></textarea><br>

        <div class="downtime-controls">

            <div class="control">
                <p class="downtime-header-1">No downtime</p>
                <input type="checkbox" id="nodowntime" class="downtime-checkbox" onclick="noDowntime()" />
                <p class="downtime-header-2">Ввести свой downtime текст </p>
                <input type="checkbox" id="freedowntime" class="downtime-checkbox" onclick="freeDowntime()" />
            </div>
        </div>
        <div class="downtimedigits" id="defaultdowntimeform">
            <p class="downtime-insert-header">Введите Downtime из Remedy</p>
            <input class="required-fields" type="text" id="downtime" placeholder="up to 8 hours"><br><br>
        </div>
        <div class="downtime-free" id="freedowntimeform">
            <p class="downtime-insert-header">Введите текст Downtime на английском</p>
            <input type="text" id="downtime-free-eng"><br>
            <p class="downtime-insert-header">Введите текст Downtime на русском</p>
            <input type="text" id="downtime-free-ru">
        </div>

        <p class="name">Дата и время начала CRQ из Remedy</p>
        <input class="required-fields" type="text" id="crq-date-start" placeholder="4/4/2018 11:00:00 AM"><br>
        <p class="name">Дата и время окончания CRQ из Remedy</p>
        <input class="required-fields" type="text" id="crq-date-end" placeholder="4/4/2018 12:00:00 PM"><br><br>

        <button onclick="fillDateTime()">Перенести данные </button>

    </div>
    <br>
    <div class=WordSection1 id="notification">
        <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%" style='width:100.0%;border-collapse:collapse'>
            <tr>
                <td valign=top style='padding:0cm 0cm 0cm 0cm'>
                    <div align=center>
                        <table id="notification-outline" class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=0 style='width:465.0pt;border-collapse:collapse'>
                            <tr>
                                <td style='background:#E6E7E8;padding:7.5pt 7.5pt 7.5pt 7.5pt'>
                                    <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=0 style='width:450.0pt;background:white;border-collapse:collapse'>
                                        <tr>
                                            <td valign=top style='padding:22.5pt 22.5pt 22.5pt 22.5pt'>
                                                <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse'>
                                                    <tr>
                                                        <td style='background:#E6E7E8;padding:7.5pt 6.0pt 7.5pt 6.0pt'>
                                                            <p class=MsoNormal align=center style='text-align:center;line-height:12.0pt'><span style='font-family:"Arial",sans-serif;color:#575757;text-transform:uppercase'>EN</span><span style='font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                                        </td>
                                                        <td style='padding:6.0pt 9.0pt 6.0pt 9.0pt'>
                                                            <p class=MsoNormal><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="alert-eng">During preventive maintenance works</span><b><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif'><o:p></o:p></span></b></p>
                                                            <p class=MsoNormal><b><span lang=EN-US><o:p>&nbsp;</o:p></span></b></p>
                                                            <p class=MsoNormal><b><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="downtime-eng">service</span></b><span lang=EN-US style='font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <p class=MsoNormal style='margin-bottom:12.0pt;line-height:12.0pt'><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#363636'><o:p>&nbsp;</o:p></span></p>
                                                <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%" style='width:100.0%;border-collapse:collapse;border-spacing: 0px'>
                                                    <tr>
                                                        <td width=359 style='width:269.25pt;border:solid #D4A001 3.0pt;padding:6.0pt 7.5pt 6.0pt 7.5pt'>
                                                         <p class=MsoNormal style='line-height:15.6pt'><i><span lang=EN-US style='font-family:"Arial",sans-serif;color:#575757;white-space: pre-wrap;'id="service-eng"></span></i><i><span lang=EN-US style='font-size:12.0pt;font-family:"Arial",sans-serif'><o:p></o:p></span></i></p>
                                                        </td>
                                                        <td nowrap style='border:solid #E6E7E8 3.0pt;border-left:none;background:#E6E7E8;padding:6.0pt 7.5pt 6.0pt 7.5pt'>
                                                            <p class=MsoNormal style='line-height:15.6pt'><span lang=EN-US style='font-family:"Arial",sans-serif;color:#575757' id="date-eng">1 January</span><b><br><span style='font-family:"Arial",sans-serif;color:#575757' id="time-eng">01:00 &ndash; 01:10</span></b><span lang=EN-US style='font-family:"Arial",sans-serif' id="toggleBoldTimeEng"><br></span><span lang=EN-US style='font-size:10.0pt;font-family:"Arial",sans-serif;color:#575757'>(Moscow time)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span lang=EN-US style='font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <!--                                                <p style='margin:0cm;margin-bottom:.0001pt;mso-line-height-alt:0pt'><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif'><o:p>&nbsp;</o:p></span></p>-->
                                                <p style='text-align:justify;mso-line-height-alt:0pt'><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="note-eng">During the maintenance works we will<o:p></o:p></span></p>
                                                <p style='margin:0cm;margin-bottom:.0001pt;text-align:justify;mso-line-height-alt:0pt'><span lang=EN-US style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757'>If you get any issues after the maintenance works feel free to contact us in any available way.<o:p></o:p></span></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style='background:#E6E7E8;padding:0cm 0cm 0cm 0cm'>
                                                <p class=MsoNormal style='line-height:7.5pt'><span lang=EN-US style='font-size:7.5pt;font-family:"Arial",sans-serif'>&nbsp;<o:p></o:p></span></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign=top style='padding:22.5pt 22.5pt 22.5pt 22.5pt;font-stretch: normal'>
                                                <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 style='border-collapse:collapse;border-spacing: 0px'>
                                                    <tr>
                                                        <td style='background:#E6E7E8;padding:7.5pt 6.0pt 7.5pt 6.0pt;border-spacing: 0px'>
                                                            <p class=MsoNormal align=center style='text-align:center;line-height:12.0pt'><span style='font-family:"Arial",sans-serif;color:#575757;text-transform:uppercase'>RU</span><span style='font-size:12.0pt;font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                                        </td>
                                                        <td style='padding:6.0pt 9.0pt 6.0pt 9.0pt'>
                                                            <p class=MsoNormal><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="alert-ru">Будут проводиться профилактические работы,</span><b><span style='font-size:10.5pt;font-family:"Arial",sans-serif'><o:p></o:p></span></b></p>
                                                            <p class=MsoNormal><b><o:p>&nbsp;</o:p></b></p>
                                                            <p class=MsoNormal><b><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="downtime-ru">сервис</span></b><b><span style='font-family:"Arial",sans-serif'><o:p></o:p></span></b></p>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <p class=MsoNormal style='margin-bottom:12.0pt;line-height:12.0pt'><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#363636'><o:p>&nbsp;</o:p></span></p>
                                                <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width="100%" style='width:100.0%;border-collapse:collapse;border-spacing: 0px'>
                                                    <tr>
                                                        <td width=362 style='width:271.5pt;border:solid #D4A001 3.0pt;padding:6.0pt 7.5pt 6.0pt 7.5pt'>
                                                            <p class=MsoNormal style='line-height:15.6pt'><i><span lang=EN-US style='font-family:"Arial",sans-serif;color:#575757;white-space: pre-wrap;' id="service-ru"></span></i><i><span style='font-size:12.0pt;font-family:"Arial",sans-serif'><o:p></o:p></span></i></p>
                                                        </td>
                                                        <td nowrap style='border:solid #E6E7E8 3.0pt;border-left:none;background:#E6E7E8;padding:6.0pt 7.5pt 6.0pt 7.5pt'>
                                                            <p class=MsoNormal style='line-height:15.6pt'><span style='font-family:"Arial",sans-serif;color:#575757' id="date-ru">1 января</span><b><br><span style='font-family:"Arial",sans-serif;color:#575757' id="time-ru" >01:00 &ndash; 01:10</span></b><span style='font-family:"Arial",sans-serif' id="toggleBoldTimeRu"><br></span><span style='font-size:10.0pt;font-family:"Arial",sans-serif;color:#575757'>(Московское время)</span><span style='font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <p style='margin:0cm;margin-bottom:.0001pt;mso-line-height-alt:0pt'><span style='font-size:11.0pt;font-family:"Calibri",sans-serif'><o:p>&nbsp;</o:p></span></p>
                                                <p style='margin:0cm;margin-bottom:.0001pt;text-align:justify;mso-line-height-alt:0pt'><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757' id="note-ru">Во время проведения работ мы<o:p></o:p></span></p>
                                                <p style='margin:0cm;margin-bottom:.0001pt;text-align:justify;mso-line-height-alt:0pt'><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757'><o:p>&nbsp;</o:p></span></p>
                                                <p style='margin:0cm;margin-bottom:.0001pt;text-align:justify;mso-line-height-alt:0pt'><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#575757'>Если у вас возникнут какие-либо трудности после проведённых работ, свяжитесь с нами любым доступным способом.</span><span style='font-size:10.5pt;font-family:"Arial",sans-serif;color:#1F497D'><o:p></o:p></span></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style='background:#E6E7E8;padding:7.5pt 7.5pt 7.5pt 7.5pt'>
                                                <p class=MsoNormal style='line-height:15.6pt'><strong><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>IT</span></strong><strong><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'> </span></strong><strong><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>Service</span></strong><strong><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'> </span></strong><strong><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>Desk</span></strong><span style='font-size:9.0pt;font-family:"Arial",sans-serif'><br></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Global</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'> </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Service</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'> </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Desk</span><span class=apple-converted-space><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'>|</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;<span class=apple-converted-space>&nbsp;</span><span style='color:#575757'>Corporate</span></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'> </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Information</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'> </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Technology</span><span class=apple-converted-space><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'>|</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;<span class=apple-converted-space>&nbsp;</span><span style='color:#575757'>Kaspersky</span></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'> </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>Lab</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'><br>+7(495)797-87-00 </span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>ext</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'>.1500<br></span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>E</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'>-</span><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>mail</span><span style='font-size:9.0pt;font-family:"Arial",sans-serif'>:</span><span class=apple-converted-space><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'>&nbsp;</span></span><a href="mailto:servicedesk@kaspersky.com"><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>servicedesk@kaspersky.com</span></a><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'><br>Please contact us at:<span class=apple-converted-space>&nbsp;</span></span><a href="https://myit.kaspersky.com/"><b><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif;color:#575757'>https://myit.kaspersky.com/</span></b></a><span lang=RU-RU style='font-size:9.0pt;font-family:"Arial",sans-serif'><o:p></o:p></span></p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
        <p class=MsoNormal><span lang=RU-RU><o:p>&nbsp;</o:p></span></p>
    </div>




</body>

<footer>
    <script>
        //по чекбоксу  nodowntime очищаем поле downtime, дизейблим его и заполняем текст о даунтайме в нотификации
        function noDowntime() {

            if (document.getElementById("nodowntime").checked) {
                document.getElementById("downtime").disabled = true;
                document.getElementById("downtime").value = "";
                document.getElementById('downtime-eng').innerHTML = "service will be fully available.";
                document.getElementById('downtime-ru').innerHTML = "сервис будет полностью доступен.";
                document.getElementById("downtime").setAttribute("placeholder", "");
            } else {
                document.getElementById("downtime").disabled = false;

                document.getElementById("downtime").setAttribute("placeholder", "up to 8 hours");
                document.getElementById('downtime-eng').innerHTML = "service";
                document.getElementById('downtime-ru').innerHTML = "сервис";
            }



        }

        //если нажат чекбокс заполняем during the maintenance works
        function enableReminder() {

            if (document.getElementById("reminder").checked) {
                document.getElementById('alert-eng').innerHTML = "Reminding about maintenance works,";
                document.getElementById('alert-ru').innerHTML = "Напоминаем о профилактических работах,";
            } else {
                document.getElementById('alert-eng').innerHTML = "During preventive maintenance works";
                document.getElementById('alert-ru').innerHTML = "Будут проводиться профилактические работы,";
            }

        }


        //функция получает на вход объект полученный по Id в виде даты типа 3/20/2018 12:28:12 PM, и возвращает массив с названием месяца на английском и на русском
        function numberToMonth(unrefinedDate) {
            var crqMonth = unrefinedDate.value.split(" ")[0].split("/")[0];
            var enMonths = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            var ruMonths = ["января", "февраля", "марта", "апреля", "мая", "июня", "июля", "августа", "сентября", "октября", "ноября", "декабря"];

            var bothMonths = [];

            bothMonths[0] = enMonths[crqMonth - 1];
            bothMonths[1] = ruMonths[crqMonth - 1];

            return bothMonths;

        }


        //по клику на чекбокс freedowntime очищает поле downtime, скрывает дефолтную форму ввода даунтайма и показывает форму свободного ввода. 
        //По второму клику чистит свободную форму и совершает обратную операцию над формами
        function freeDowntime() {
            if (document.getElementById("freedowntime").checked) {

                var defaultDowntimeField = document.getElementById("defaultdowntimeform");
                defaultDowntimeField.setAttribute("style", "display:none");
                var freeDowntimeField = document.getElementById("freedowntimeform");
                freeDowntimeField.setAttribute("style", "display:block");

                document.getElementById("nodowntime").disabled = true;
                document.getElementById("downtime").value = "";

                document.getElementById("nodowntime").checked = false;



            } else {
                var defaultDowntimeField = document.getElementById("defaultdowntimeform");
                defaultDowntimeField.setAttribute("style", "display:block");
                var freeDowntimeField = document.getElementById("freedowntimeform");
                freeDowntimeField.setAttribute("style", "display:none");
                document.getElementById("downtime").disabled = false;
                document.getElementById("nodowntime").disabled = false;


                //на всякий случай обнуляем поля свободного ввода даунтайма, если вдруг чекбокс freedowntime сняли
                document.getElementById("downtime-free-eng").value = "";
                document.getElementById("downtime-free-ru").value = "";
            }
        }


        //на вход получаем объект, вытаскиваем из него время и переводим в человеческий 24-часовой вид
        function parseTime(unrefinedDate) {

            var crqTime = unrefinedDate.value.split(" ")[1].slice(0, -3);
            crqTime = crqTime.concat(" ").concat(unrefinedDate.value.split(" ")[2]);

            var input = crqTime,
                matches = input.toLowerCase().match(/(\d{1,2}):(\d{2}) ([ap]m)/);
            var refinedTime;
            var tempTime = matches[0];



            if (/12:\d{2} am/.test(tempTime)) {

                refinedTime = tempTime.replace(/12/g, "00");
                refinedTime = refinedTime.slice(0, -3);


            } else if (/12:\d{2} pm/.test(tempTime)) {

                refinedTime = tempTime.replace(/^12/g, "12");
                refinedTime = refinedTime.slice(0, -3);
            } else {

                refinedTime = (parseInt(matches[1]) + (matches[3] == 'pm' ? 12 : 0)) + ':' + matches[2];

            }

            return refinedTime;

        }


        //подцепляем все данные из форм, трансформируем их функциями и заполняем ими нашу нотификацию
        function fillDateTime() {

            if ((!document.getElementById("crq-date-start").value == "") && (!document.getElementById("crq-date-end").value == "")) {

                //Забираем инфу из форм
                document.getElementById("note-ru").innerHTML = document.getElementById("insert-note-ru").value;
                document.getElementById("note-eng").innerHTML = document.getElementById("insert-note-en").value;

                
                //суперфукция пришивающая br к каждой строке из поля insert-service                
                var servicetext = $("#insert-service").val().split("\n");
                var serviceout= "";
                
                for (var i= 0;i<servicetext.length;i++){
                    
                    if(i!=servicetext.length-1){
                        servicetext[i] = servicetext[i]+"<br>";
                    }
                    
                    serviceout = serviceout + servicetext[i]
                    
                }
                document.getElementById("service-ru").innerHTML = serviceout;
                document.getElementById("service-eng").innerHTML = serviceout;
                



                //приводим дату, время, месяц в красивый вид
                var formDateStart = document.getElementById('crq-date-start'),
                    monthsArrayStart = numberToMonth(formDateStart),
                    dayStart = formDateStart.value.split(" ")[0].split("/")[1],
                    timeStart = parseTime(formDateStart);

                var formDateEnd = document.getElementById('crq-date-end'),
                    monthsArrayEnd = numberToMonth(formDateEnd),
                    dayEnd = formDateEnd.value.split(" ")[0].split("/")[1],
                    timeEnd = parseTime(formDateEnd);

                var dateEng = dayStart + " " + monthsArrayStart[0],
                    dateRu = dayStart + " " + monthsArrayStart[1],
                    interval = timeStart + " &ndash; " + timeEnd;



                //если CRQ более чем на 1 день
                if (formDateStart.value.split(" ")[0] != formDateEnd.value.split(" ")[0]) {


                    //собрали красивые данные в строку
                    var intervalDateEng = dayStart + " " + monthsArrayStart[0] + " " + timeStart + " — <br>" + dayEnd + " " + monthsArrayEnd[0] + " " + timeEnd,
                        intervalDateRu = dayStart + " " + monthsArrayStart[1] + " " + timeStart + " — <br>" + dayEnd + " " + monthsArrayEnd[1] + " " + timeEnd;



                    //залили в нотификацию
                    document.getElementById("date-eng").innerHTML = intervalDateEng;
                    document.getElementById("date-ru").innerHTML = intervalDateRu;

                    document.getElementById("time-eng").innerHTML = "";
                    document.getElementById("time-ru").innerHTML = "";

                    var emptySpaceRu = document.getElementById("toggleBoldTimeRu");
                    var emptySpaceEng = document.getElementById("toggleBoldTimeEng");

                    emptySpaceEng.setAttribute("style", "display:none");
                    emptySpaceRu.setAttribute("style", "display:none");

                } else {

                    //если стандартная нотификация(работы в 1 день)
                    document.getElementById("date-ru").innerHTML = dateRu;
                    document.getElementById("date-eng").innerHTML = dateEng;

                    document.getElementById("time-ru").innerHTML = interval;
                    document.getElementById("time-eng").innerHTML = interval;

                    var emptySpaceRu = document.getElementById("toggleBoldTimeRu");
                    var emptySpaceEng = document.getElementById("toggleBoldTimeEng");

                    emptySpaceEng.setAttribute("style", "display:inline");
                    emptySpaceRu.setAttribute("style", "display:inline");

                }


                //заполнили даунтайм
                //На всякий случай проверяем, что дефолтное значение текстбокса downtime не пустое, пустое оно по умолчанию, либо если нажат чекбокс freedowntime; поле чистится в функции freeDowntime()

                if (!document.getElementById("nodowntime").checked) {
                    if (!document.getElementById("downtime").value == "") {
                        parseDowntime();
                    } else {
                        document.getElementById('downtime-eng').innerHTML = document.getElementById("downtime-free-eng").value;
                        document.getElementById('downtime-ru').innerHTML = document.getElementById("downtime-free-ru").value;
                    }

                }

                document.getElementById("notification-outline").setAttribute("style", "outline:none");

            } else alert("Заполните поля начала и окончания CRQ");
        }


        //функция берёт значение из дефолтного поля downtime, и в зависимости от значений заполняет текста даунтайма
        function parseDowntime() {

            var dt = document.getElementById("downtime").value;

            if (/^((\d{1,2}) x (\d{1,2}) min)$/.test(dt)) {
                var qty = dt.split(" ")[0],
                    minutes = dt.split(" ")[2];

                var ruQtyModifier = " раза по ";

                if (parseInt(qty) > 4) ruQtyModifier = " раз по ";


                document.getElementById("downtime-eng").innerHTML = "service will be unavailable for " + qty + " times " + minutes + " minutes each.";
                document.getElementById("downtime-ru").innerHTML = "сервис будет недоступен " + qty + ruQtyModifier + minutes + " минут.";

            } else if (/^(up to (\d{1,2}) (day|days|hour|hours|min))$/.test(dt)) {

                var downtime = dt.split(" ")[2],
                    measureEng = dt.split(" ")[3],
                    measureRu;

                switch (measureEng) {
                    case "hours":
                        if (/^(22|23|24|4|3|2)$/.test(downtime)) {
                            measureRu = "часа";

                        } else if (/^(21)$/.test(downtime)) {
                            measureRu = "час";
                        } else {
                            measureRu = "часов";
                        }
                        break;
                    case "hour":
                        measureRu = "час";
                        break;
                    case "day":
                        measureRu = "день";
                        break;
                    case "days":
                        measureRu = "дня";
                        break;
                    case "min":
                        measureEng = "minutes";
                        measureRu = "минут";
                        break;

                }


                document.getElementById("downtime-eng").innerHTML = "service will be unavailable for " + downtime + " " + measureEng + ".";
                document.getElementById("downtime-ru").innerHTML = "сервис будет недоступен " + downtime + " " + measureRu + ".";

            }

        }



        //функция получения информации по одному чейнджу
        function getSingleChangeInfo() {

            var response;
            var userCRQ = document.getElementById("changefield").value;

            var requestString = 'requeststr= SELECT [Infrastructure_change_ID],[ServiceCI],[KSP_Downtime],[Scheduled_Start_Date],[Scheduled_End_Date] FROM [hqitsm-db-arsys].[ARSystem].[dbo].[CHG_Infrastructure_Change] WHERE Infrastructure_Change_ID =\'' + userCRQ + '\'';

            var myconnection = $.ajax({
                mimeType: 'multipart/form-data',
                data: requestString,
                method: 'POST',
                async: false,
                url: 'https://dutydashboard.avp.ru/ITSM_Reports_API/Home/Request',
                processData: false,
                success: function(msg) {
                    response = msg;
                }
            });


            response = JSON.parse(response);


            document.getElementById("crq-date-start").value = convertUnixDate(response[0].Scheduled_Start_Date);
            document.getElementById("crq-date-end").value = convertUnixDate(response[0].Scheduled_End_Date);
            document.getElementById("insert-service").value = response[0].ServiceCI;


            if (response[0].KSP_Downtime == "no downtime") {
                document.getElementById("nodowntime").checked = true;
                noDowntime();

            } else {
                document.getElementById("downtime").value = response[0].KSP_Downtime;
            }

            fillDateTime();

        }


        //функция конвертирования из unix-даты в en-US формат
        function convertUnixDate(unixdate) {

            var curTime = new Date("1970-01-01");
            curTime.setSeconds(curTime.getSeconds() + unixdate);

            var tempDate = curTime.toLocaleDateString("en-US");
            var tempTime = curTime.toLocaleTimeString("en-US");

            var refinedDate = tempDate + " " + tempTime;

            return refinedDate;

        }

        //функция копирования ричтекста
        function copyToClip(str) {
            function listener(e) {
                e.clipboardData.setData("text/html", str);
                e.clipboardData.setData("text/plain", str);
                e.preventDefault();
            }
            document.addEventListener("copy", listener);
            document.execCommand("copy");
            document.removeEventListener("copy", listener);
        };


        
        $(document).ready(function() {
            new ClipboardJS("#copybutton");


            //real-time заполнение полей уведомления из формы    
            var oldVal = "";
            $("#insert-note-en").on("change keyup paste", function() {
                var currentVal = $(this).val();
                if (currentVal == oldVal) {
                    return;
                }

                oldVal = currentVal;

                document.getElementById("note-eng").innerHTML = document.getElementById("insert-note-en").value;
            });

            $("#insert-note-ru").on("change keyup paste", function() {
                var currentVal = $(this).val();
                if (currentVal == oldVal) {
                    return;
                }

                oldVal = currentVal;

                document.getElementById("note-ru").innerHTML = document.getElementById("insert-note-ru").value;
            });
            

            $("#changefield").on("keydown", function(e) {

                if (e.which == 13) {
                    getSingleChangeInfo();
                }

            });


        });

    </script>
</footer>

</html>
